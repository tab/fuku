version: 1

x-readiness: &readiness
  type: log
  timeout: 30s

services:
  # Foundation tier: Base infrastructure services
  auth:
    dir: examples/bookstore/auth
    tier: foundation
    readiness:
      <<: *readiness
      pattern: "Service ready"
  storage:
    dir: examples/bookstore/storage
    tier: foundation
    readiness:
      <<: *readiness
      pattern: "Service ready"

  # Platform tier: Business logic services that depend on foundation
  user:
    dir: examples/bookstore/user
    tier: platform
    readiness:
      <<: *readiness
      pattern: "Service ready"

  api:
    dir: examples/bookstore/api
    tier: platform
    readiness:
      <<: *readiness
      pattern: "Service ready"

  # Edge tier: Client-facing services
  frontend-api:
    dir: examples/bookstore/frontend-api
    tier: edge
    profiles: [core]
    readiness:
      <<: *readiness
      pattern: "Service ready"

defaults:
  profiles: [default]

profiles:
  default: "*"                        # All services
  core: [api, frontend-api, storage]  # Core services for typical development
  minimal: [api, storage]             # Minimal set for lightweight testing

concurrency:
  workers: 10

retry:
  attempts: 5
  backoff: 1s

logs:
  buffer: 500

logging:
  level: debug
  format: console
